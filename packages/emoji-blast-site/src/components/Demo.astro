---
import { Code } from "@astrojs/starlight/components";
import dedent from "dedent";

import { getDemo, type DemosGroup } from "~/data/demos";
import { slugify } from "~/data/slugify";

import { DemoButton } from "./DemoGroup";

interface Props {
	group: DemosGroup;
	title: string;
}

const { group, title } = Astro.props;
const demo = getDemo(group, title);

const lines = demo.blaster
	.toString()
	.replaceAll("__vite_ssr_import_0__.", "")
	.replaceAll("(0,emojiBlast)", "emojiBlast")
	.replaceAll(/(\d)e3/g, "$1000")
	.split("\n");

const code = dedent(lines.slice(1, lines.length - 1).join("\n"));
---

<div class="demo" id={slugify(demo.title)}>
	<div class="demo-first">
		<div class="demo-text">
			<h2>{title}</h2>
			<p>{demo.blurb}</p>
		</div>
		<DemoButton
			className="demo-button"
			client:load
			group={Astro.props.group}
			title={Astro.props.title}
		/>
	</div>

	<Code code={code} lang="javascript" />
</div>

<style>
	.demo-first {
		align-items: flex-end;
		display: grid;
		gap: 0 1rem;
		grid-template-columns: 1fr auto;
	}

	.demo-text {
		display: contents;
	}

	h2 {
		grid-column: 1 / 3;
		grid-row: 1 / 1;
		width: 100%;
	}

	p {
		grid-column: 1 / 1;
		grid-row: 2 / 2;
	}

	.demo-button {
		grid-column: 2 / 2;
		grid-row: 2 /2;
	}
</style>
