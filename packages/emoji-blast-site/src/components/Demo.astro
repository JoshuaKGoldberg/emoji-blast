---
import { Code } from "@astrojs/starlight/components";

interface Props {
	importSource: string; // e.g. "basic/inverse-gravity.ts"
}

// todo: move to a file
interface ExampleData {
	name: string;
	blurb: string;
	codeSnippet: string;
	explosionFunction: () => void;
}

const examples = import.meta.glob<ExampleData>("./examples/*/*.ts");

const example = await examples[`./examples/${Astro.props.importSource}`]();

console.log({ example });
---

<emoji-blast-demo data-import-source={Astro.props.importSource}>
	<h1>{example.name}</h1>
	<p>{example.blurb}</p>

	<button>try it :3</button>

	<Code code={example.codeSnippet} lang="js" />
</emoji-blast-demo>

<script>
	// todo: move to a file
	interface ExampleData {
		name: string;
		blurb: string;
		codeSnippet: string;
		explosionFunction: () => void;
	}

	const examples = import.meta.glob<ExampleData>("./examples/*/*.ts");

	class EmojiBlastDemo extends HTMLElement {
		constructor() {
			super();

			const { importSource } = this.dataset;

			(async () => {
				const example = await examples[`./examples/${importSource}`]();

				this.querySelector("button")!.addEventListener("click", () => {
					example.explosionFunction();
				});
			})();
		}
	}

	customElements.define("emoji-blast-demo", EmojiBlastDemo);
</script>
